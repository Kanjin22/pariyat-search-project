[
    {
        "label": "os",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "os",
        "description": "os",
        "detail": "os",
        "documentation": {}
    },
    {
        "label": "Flask",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "render_template",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "jsonify",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "request",
        "importPath": "flask",
        "description": "flask",
        "isExtraImport": true,
        "detail": "flask",
        "documentation": {}
    },
    {
        "label": "pandas",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "pandas",
        "description": "pandas",
        "detail": "pandas",
        "documentation": {}
    },
    {
        "label": "datetime",
        "importPath": "datetime",
        "description": "datetime",
        "isExtraImport": true,
        "detail": "datetime",
        "documentation": {}
    },
    {
        "label": "pytz",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "pytz",
        "description": "pytz",
        "detail": "pytz",
        "documentation": {}
    },
    {
        "label": "requests",
        "kind": 6,
        "isExtraImport": true,
        "importPath": "requests",
        "description": "requests",
        "detail": "requests",
        "documentation": {}
    },
    {
        "label": "to_thai_digits",
        "kind": 2,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "def to_thai_digits(text):\n    if text is None or pd.isna(text): return ''\n    text = str(text)\n    thai_digits = str.maketrans('0123456789', '๐๑๒๓๔๕๖๗๘๙')\n    return text.translate(thai_digits)\ndef validate_thai_id(pid):\n    if not isinstance(pid, str) or not pid.isdigit() or len(pid) != 13:\n        return False\n    total = sum(int(digit) * (13 - i) for i, digit in enumerate(pid[:12]))\n    check_digit = (11 - (total % 11)) % 10",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "validate_thai_id",
        "kind": 2,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "def validate_thai_id(pid):\n    if not isinstance(pid, str) or not pid.isdigit() or len(pid) != 13:\n        return False\n    total = sum(int(digit) * (13 - i) for i, digit in enumerate(pid[:12]))\n    check_digit = (11 - (total % 11)) % 10\n    return int(pid[12]) == check_digit\ndef extract_latest_cert(id_list_string, latest_id):\n    if not id_list_string or not latest_id or not isinstance(id_list_string, str): return ''\n    history_list = id_list_string.split(',')\n    search_key = f\"{latest_id}:\"",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "extract_latest_cert",
        "kind": 2,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "def extract_latest_cert(id_list_string, latest_id):\n    if not id_list_string or not latest_id or not isinstance(id_list_string, str): return ''\n    history_list = id_list_string.split(',')\n    search_key = f\"{latest_id}:\"\n    for entry in history_list:\n        clean_entry = entry.strip()\n        if clean_entry.startswith(search_key):\n            return clean_entry.split(':', 1)[1].strip()\n    return ''\ndef get_current_buddhist_year(numeric=False):",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "get_current_buddhist_year",
        "kind": 2,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "def get_current_buddhist_year(numeric=False):\n    today = datetime.now()\n    buddhist_year = today.year + 543\n    if today >= datetime(today.year, 6, 1):\n        buddhist_year += 1\n    if numeric:\n        return buddhist_year\n    return to_thai_digits(str(buddhist_year))\ndef format_display_name(row):\n    prefix = row.get('prefix_title', '') or ''",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "format_display_name",
        "kind": 2,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "def format_display_name(row):\n    prefix = row.get('prefix_title', '') or ''\n    fname = row.get('firstname', '') or ''\n    lname = row.get('lastname', '') or ''\n    pname = row.get('paliname', '') or ''\n    full_first_name = f\"{prefix}{fname}\"\n    if pname:\n        display_name = \" \".join(part for part in [full_first_name, pname] if part)\n        if lname: display_name += f\" ({lname})\"\n        return display_name",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "load_data_from_api",
        "kind": 2,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "def load_data_from_api():\n    global df\n    API_URL = \"https://app.pariyat.com/pages/postx/name_json.php\"\n    current_year_numeric = get_current_buddhist_year(numeric=True)\n    PARAMS = {'user': 'dh', 'pass': 'dhahiw8425', 'filter_year': current_year_numeric}\n    try:\n        response = requests.get(API_URL, params=PARAMS, timeout=60)\n        json_data = response.json()\n        if json_data.get('status') == 'success' and 'data' in json_data:\n            raw_df = pd.DataFrame(json_data['data'])",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "search",
        "kind": 2,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "def search():\n    query = request.args.get('q', '')\n    if df is None or df.empty or query == '': return jsonify([])\n    results_df = df[df['display_name'].str.contains(query, case=False, na=False)]\n    if results_df.empty: return jsonify([])\n    grouped = results_df.groupby('display_name')\n    final_results = []\n    for name, group in grouped:\n        first_row = group.iloc[0]\n        id_card_raw = first_row.get('id_card', '')",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "index",
        "kind": 2,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "def index():\n    current_year_thai = get_current_buddhist_year(numeric=False)\n    return render_template('index.html', current_buddhist_year=current_year_thai)\n@app.route('/get_data_info')\ndef get_data_info():\n    return jsonify({'timestamp': get_data_timestamp(), 'count': len(df) if df is not None else 0})\ndef get_data_timestamp():\n    bangkok_tz = pytz.timezone(\"Asia/Bangkok\")\n    return datetime.now(bangkok_tz).strftime('%d/%m/%Y %H:%M:%S')\nload_data_from_api()",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "get_data_info",
        "kind": 2,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "def get_data_info():\n    return jsonify({'timestamp': get_data_timestamp(), 'count': len(df) if df is not None else 0})\ndef get_data_timestamp():\n    bangkok_tz = pytz.timezone(\"Asia/Bangkok\")\n    return datetime.now(bangkok_tz).strftime('%d/%m/%Y %H:%M:%S')\nload_data_from_api()\nif __name__ == '__main__':\n    app.run(debug=True)",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "get_data_timestamp",
        "kind": 2,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "def get_data_timestamp():\n    bangkok_tz = pytz.timezone(\"Asia/Bangkok\")\n    return datetime.now(bangkok_tz).strftime('%d/%m/%Y %H:%M:%S')\nload_data_from_api()\nif __name__ == '__main__':\n    app.run(debug=True)",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "BASE_DIR",
        "kind": 5,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\nTEMPLATE_DIR = os.path.join(BASE_DIR, 'templates')\nSTATIC_DIR = os.path.join(BASE_DIR, 'app', 'static')\napp = Flask(__name__, template_folder=TEMPLATE_DIR, static_folder=STATIC_DIR)\ndf = None\nLEVEL_ID_MAP = {\n    '5001': 'น.ธ.ตรี', '5002': 'น.ธ.โท', '5003': 'น.ธ.เอก', '5004': 'ธ.ศ.ตรี',\n    '5005': 'ธ.ศ.โท', '5006': 'ธ.ศ.เอก', '5007': 'บ.ศ.๑-๒', '5008': 'บ.ศ.๓',\n    '5009': 'บ.ศ.๔', '5010': 'บ.ศ.๕', '5011': 'บ.ศ.๖', '5012': 'บ.ศ.๗',\n    '5013': 'บ.ศ.๘', '5014': 'บ.ศ.๙', '5015': 'ป.๑-๒', '5016': 'ป.ธ.๓',",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "TEMPLATE_DIR",
        "kind": 5,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "TEMPLATE_DIR = os.path.join(BASE_DIR, 'templates')\nSTATIC_DIR = os.path.join(BASE_DIR, 'app', 'static')\napp = Flask(__name__, template_folder=TEMPLATE_DIR, static_folder=STATIC_DIR)\ndf = None\nLEVEL_ID_MAP = {\n    '5001': 'น.ธ.ตรี', '5002': 'น.ธ.โท', '5003': 'น.ธ.เอก', '5004': 'ธ.ศ.ตรี',\n    '5005': 'ธ.ศ.โท', '5006': 'ธ.ศ.เอก', '5007': 'บ.ศ.๑-๒', '5008': 'บ.ศ.๓',\n    '5009': 'บ.ศ.๔', '5010': 'บ.ศ.๕', '5011': 'บ.ศ.๖', '5012': 'บ.ศ.๗',\n    '5013': 'บ.ศ.๘', '5014': 'บ.ศ.๙', '5015': 'ป.๑-๒', '5016': 'ป.ธ.๓',\n    '5017': 'ป.ธ.๔', '5018': 'ป.ธ.๕', '5019': 'ป.ธ.๖', '5020': 'ป.ธ.๗',",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "STATIC_DIR",
        "kind": 5,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "STATIC_DIR = os.path.join(BASE_DIR, 'app', 'static')\napp = Flask(__name__, template_folder=TEMPLATE_DIR, static_folder=STATIC_DIR)\ndf = None\nLEVEL_ID_MAP = {\n    '5001': 'น.ธ.ตรี', '5002': 'น.ธ.โท', '5003': 'น.ธ.เอก', '5004': 'ธ.ศ.ตรี',\n    '5005': 'ธ.ศ.โท', '5006': 'ธ.ศ.เอก', '5007': 'บ.ศ.๑-๒', '5008': 'บ.ศ.๓',\n    '5009': 'บ.ศ.๔', '5010': 'บ.ศ.๕', '5011': 'บ.ศ.๖', '5012': 'บ.ศ.๗',\n    '5013': 'บ.ศ.๘', '5014': 'บ.ศ.๙', '5015': 'ป.๑-๒', '5016': 'ป.ธ.๓',\n    '5017': 'ป.ธ.๔', '5018': 'ป.ธ.๕', '5019': 'ป.ธ.๖', '5020': 'ป.ธ.๗',\n    '5021': 'ป.ธ.๘', '5022': 'ป.ธ.๙'",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "app",
        "kind": 5,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "app = Flask(__name__, template_folder=TEMPLATE_DIR, static_folder=STATIC_DIR)\ndf = None\nLEVEL_ID_MAP = {\n    '5001': 'น.ธ.ตรี', '5002': 'น.ธ.โท', '5003': 'น.ธ.เอก', '5004': 'ธ.ศ.ตรี',\n    '5005': 'ธ.ศ.โท', '5006': 'ธ.ศ.เอก', '5007': 'บ.ศ.๑-๒', '5008': 'บ.ศ.๓',\n    '5009': 'บ.ศ.๔', '5010': 'บ.ศ.๕', '5011': 'บ.ศ.๖', '5012': 'บ.ศ.๗',\n    '5013': 'บ.ศ.๘', '5014': 'บ.ศ.๙', '5015': 'ป.๑-๒', '5016': 'ป.ธ.๓',\n    '5017': 'ป.ธ.๔', '5018': 'ป.ธ.๕', '5019': 'ป.ธ.๖', '5020': 'ป.ธ.๗',\n    '5021': 'ป.ธ.๘', '5022': 'ป.ธ.๙'\n}",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "df",
        "kind": 5,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "df = None\nLEVEL_ID_MAP = {\n    '5001': 'น.ธ.ตรี', '5002': 'น.ธ.โท', '5003': 'น.ธ.เอก', '5004': 'ธ.ศ.ตรี',\n    '5005': 'ธ.ศ.โท', '5006': 'ธ.ศ.เอก', '5007': 'บ.ศ.๑-๒', '5008': 'บ.ศ.๓',\n    '5009': 'บ.ศ.๔', '5010': 'บ.ศ.๕', '5011': 'บ.ศ.๖', '5012': 'บ.ศ.๗',\n    '5013': 'บ.ศ.๘', '5014': 'บ.ศ.๙', '5015': 'ป.๑-๒', '5016': 'ป.ธ.๓',\n    '5017': 'ป.ธ.๔', '5018': 'ป.ธ.๕', '5019': 'ป.ธ.๖', '5020': 'ป.ธ.๗',\n    '5021': 'ป.ธ.๘', '5022': 'ป.ธ.๙'\n}\ndef to_thai_digits(text):",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "LEVEL_ID_MAP",
        "kind": 5,
        "importPath": "app.app",
        "description": "app.app",
        "peekOfCode": "LEVEL_ID_MAP = {\n    '5001': 'น.ธ.ตรี', '5002': 'น.ธ.โท', '5003': 'น.ธ.เอก', '5004': 'ธ.ศ.ตรี',\n    '5005': 'ธ.ศ.โท', '5006': 'ธ.ศ.เอก', '5007': 'บ.ศ.๑-๒', '5008': 'บ.ศ.๓',\n    '5009': 'บ.ศ.๔', '5010': 'บ.ศ.๕', '5011': 'บ.ศ.๖', '5012': 'บ.ศ.๗',\n    '5013': 'บ.ศ.๘', '5014': 'บ.ศ.๙', '5015': 'ป.๑-๒', '5016': 'ป.ธ.๓',\n    '5017': 'ป.ธ.๔', '5018': 'ป.ธ.๕', '5019': 'ป.ธ.๖', '5020': 'ป.ธ.๗',\n    '5021': 'ป.ธ.๘', '5022': 'ป.ธ.๙'\n}\ndef to_thai_digits(text):\n    if text is None or pd.isna(text): return ''",
        "detail": "app.app",
        "documentation": {}
    },
    {
        "label": "URL_TO_DEBUG",
        "kind": 5,
        "importPath": "scraper.debug_scraper",
        "description": "scraper.debug_scraper",
        "peekOfCode": "URL_TO_DEBUG = \"https://app.pariyat.com/pages/postx/namelist.php?lid=5015\"\nHEADERS = {\n    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\n}\nprint(f\"กำลังเริ่มชันสูตร URL: {URL_TO_DEBUG}\")\ntry:\n    response = requests.get(URL_TO_DEBUG, headers=HEADERS)\n    response.raise_for_status()\n    with open(\"debug_page.html\", \"wb\") as f: \n        f.write(response.content)",
        "detail": "scraper.debug_scraper",
        "documentation": {}
    },
    {
        "label": "HEADERS",
        "kind": 5,
        "importPath": "scraper.debug_scraper",
        "description": "scraper.debug_scraper",
        "peekOfCode": "HEADERS = {\n    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\n}\nprint(f\"กำลังเริ่มชันสูตร URL: {URL_TO_DEBUG}\")\ntry:\n    response = requests.get(URL_TO_DEBUG, headers=HEADERS)\n    response.raise_for_status()\n    with open(\"debug_page.html\", \"wb\") as f: \n        f.write(response.content)\n    print(\"\\n✅ ชันสูตรสำเร็จ!\")",
        "detail": "scraper.debug_scraper",
        "documentation": {}
    }
]